Bootstrap: docker
From: ubuntu:22.04

%environment
    export EIGEN_INCLUDE_DIR=/usr/include/eigen3
    export PYTHONPATH="/home/utils:${PYTHONPATH}"

%post
    apt-get update && \
    apt-get install -y \
        python3 \
        python3-pip \
        unzip \
        cmake \
        g++ \
        pkg-config \
        libgsl-dev \
        povray \
        libgmp-dev \
        libmpfr-dev \
        libeigen3-dev \
        libcgal-dev \
        tetgen \
        libgl1 \
        libxrender1 \
        libxext6 \
        libsm6 \
        libx11-6 \
    && apt-get clean && rm -rf /var/lib/apt/lists/*

    mkdir -p /root/Progs
    unzip /root/pygalmesh-main.zip -d /root/Progs

    sed -i 's|include_dirs=\[os.environ.get("EIGEN_INCLUDE_DIR", "/usr/include/eigen3/")\]|include_dirs=["/usr/include/eigen3"]|g' /root/Progs/pygalmesh-main/setup.py

    pip3 install /root/Progs/pygalmesh-main
    pip3 install tifffile scipy h5py pandas nanomesh pydicom pyvista

%files
    pygalmesh-main.zip /root/pygalmesh-main.zip

%runscript
    tail -f /dev/null






